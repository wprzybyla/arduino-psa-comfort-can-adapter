; PlatformIO Project Configuration File
;
; PSA Comfort CAN Adapter - ESP32-S3 Project
; This adapter bridges communication between CAN2004 (old BSI) and CAN2010 (modern PSA devices)
;
; Hardware: LilyGO T2CAN (ESP32-S3 with dual MCP2515 CAN controllers)
; Target: Connect modern PSA CAN2010 devices (NAC, SMEG, Color Matrix) to older vehicles
;
; For complete documentation, see:
; - README.md - Project overview and getting started
; - docs/QUICKSTART.md - Quick setup guide
; - docs/TECHNICAL.md - Complete technical documentation

[env:lilygo-t2can]
; Platform and Board Configuration - using latest official espressif32 with full S3 support
platform = espressif32@~6.8.0
board = esp32-s3-devkitc-1
monitor_speed = 115200
upload_speed = 921600
framework = arduino

; Board Build Options
board_build.partitions = default.csv
board_build.flash_mode = qio
board_build.f_flash = 80000000

; Build Flags - From working PSA Battery Emulator reference configuration
build_flags = 
    -I include
    -Wimplicit-fallthrough
    -Wextra
    -Wall
    -D HW_LILYGO2CAN
    -D BOARD_HAS_PSRAM
    -D ARDUINO_USB_MODE=1
    -D ARDUINO_USB_CDC_ON_BOOT=1
    -D ARDUINO_RUNNING_CORE=1
    -D ARDUINO_EVENT_RUNNING_CORE=1

; Library Dependencies
lib_deps = 
    autowp/autowp-mcp2515@^1.3.1
    paulstoffregen/DS1307RTC
    paulstoffregen/Time@^1.6.1

; Project Structure:
; - src/main.cpp: Main application code (CAN message processing)
; - src/can_utils.cpp: Utility functions (checksums, popups, date calculations)
; - include/BoardConfig_t2can.h: Hardware pin definitions for LilyGO T2CAN
; - include/config.h: Project configuration (CAN speed, serial speed, etc.)
; - include/can_utils.h: Function declarations
;
; CAN Bus Configuration:
; - CAN0 (destination): Connected to vehicle's CAN2004 bus (CS pin 10)
; - CAN1 (source): Connected to CAN2010 device like NAC/SMEG (CS pin 14)
; - CAN Speed: 125 kbps (Entertainment CAN bus - Low speed)
; - MCP2515 Frequency: 16 MHz
;
; Hardware Connections (LilyGO T2CAN):
; - SPI: SCK=12, MISO=13, MOSI=11
; - CAN0 CS: Pin 10 (vehicle CAN2004)
; - CAN1 CS: Pin 14 (CAN2010 device)
; - I2C: SDA=8, SCL=9 (RTC module via QWIIC interface)
;
; For troubleshooting compilation issues:
; - Ensure Python is installed (not Windows Store version)
; - Run: pio lib install (if libraries fail to install)
; - Check: docs/TECHNICAL.md for detailed troubleshooting

; Pre-build script to copy sdkconfig.t2can to build directory
extra_scripts = pre:scripts/copy_sdkconfig.py
